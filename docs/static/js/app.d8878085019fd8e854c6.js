webpackJsonp([1],{"79Kr":function(e,t){},N4os:function(e,t){},NHnr:function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=s("7+uW");const i={gain:0,fadeTime:.2,type:"sine"};class o{constructor(e,t=i){this.name=e,this.configuration=t,this.configuration.gain=this.configuration.gain||0,this.oscillators={},this.audioContext=c.audioContext,this.gainNodes={},this.notes={},this.type="classic"}handleMessage(e){switch(e.type){case"Note ON":this.message=e,this.oscillators[e.channel]||this.initOscillator(e.note,e.channel),this.oscillators[e.channel].frequency.value=c.noteToFrequency(e.note),this.notes[e.channel]=e.note;break;case"NOTE OFF":this.gainNodes[e.channel].gain.linearRampToValueAtTime(0,this.audioContext.currentTime+this.configuration.fadeTime);break;case"Channel Pressure (After-touch)":console.log("gain",e.pressure/(128+this.configuration.gain)),this.gainNodes[e.channel].gain.linearRampToValueAtTime(e.pressure/(128+this.configuration.gain),this.audioContext.currentTime+.1);break;case"Pitch Bend Change":const t=this.notes[e.channel]+e.pitchBend;isNaN(t)||this.oscillators[e.channel].frequency.exponentialRampToValueAtTime(c.noteToFrequency(t),this.audioContext.currentTime+.1)}}initOscillator(e,t){const s=c.noteToFrequency(e);let n=this.gainNodes[t],i=this.oscillators[t];n||(n=this.audioContext.createGain(),this.gainNodes[t]=n,n.gain.value=0,n.connect(this.audioContext.destination)),i||((i=this.audioContext.createOscillator()).type!==this.configuration.type&&(i.type=this.configuration.type),this.oscillators[t]=i,i.connect(n)),i.frequency.value=s,i.start()}}class a extends o{constructor(e,t=i,s,n,o=!1){super(e,t),this.periodicWave=this.audioContext.createPeriodicWave(s,n,{disableNormalization:o}),this.sin=s,this.cosin=n,this.custom=!0,this.amplitude=Math.max(...this.sin)||-1*Math.min(...this.sin),this.type="custom"}initOscillator(e,t){const s=c.noteToFrequency(e);let n=this.gainNodes[t],i=this.oscillators[t];n||(n=this.audioContext.createGain(),this.gainNodes[t]=n,n.gain.value=0,n.connect(this.audioContext.destination)),i||((i=this.audioContext.createOscillator()).setPeriodicWave(this.periodicWave),this.oscillators[t]=i,i.connect(n)),i.frequency.value=s,i.start()}}class r extends a{constructor(e,t=i,s,n=!1,o=12){const a=[],r=new Int8Array(o);a[0]=0;for(let e=1;e<o;e++)a.push(s(e));super(e,t,a,r,n),this.function=s,this.type="function"}}const c=new class{constructor(){this.onMidiMessage=null,this.audioContext=new(window.AudioContext||window.webkitAudioContext),"function"==typeof navigator.requestMIDIAccess?(console.log("MIDIController :: Compatible browser found"),this.compatibleBrowser=!0):(console.error("No requestMIDIAccess available on your browser. Please use the latest Chrome version."),this.compatibleBrowser=!1)}requestMIDIAccess(e=!1){return new Promise((t,s)=>{this.compatibleBrowser?this.MIDIAccess&&!e?t(this.MIDIAccess):navigator.requestMIDIAccess().then(e=>{this.MIDIAccess=e,this.MIDIAccess.onstatechanged=(e=>console.warn("MIDIController :: onstatechanged",e)),t(e)}).catch(e=>s(e)):s(new Error("Incompatible browser"))})}getInputs(){return new Promise((e,t)=>{this.requestMIDIAccess().then(t=>{const s=[];t.inputs.forEach(e=>s.push(e)),e(s)}).catch(e=>t(e))})}getInputsByManufacturer(e){return new Promise((t,s)=>{this.requestMIDIAccess().then(s=>{const n=[];s.inputs.forEach(t=>{t.manufacturer===e&&n.push(t)}),t(n)}).catch(e=>s(e))})}connect(e){return new Promise((t,s)=>{e.open().then(e=>{console.log("MIDIController :: Connection established",e),t(e)}).catch(e=>s(e))})}noteToFrequency(e){return 13.75*Math.pow(2,(e-9)/12)}parseMessage(e){const t={};switch(t.channelVoiceMessage=e[0],t.channel=parseInt(e[0].toString(2).slice(4),2),t.data1=parseInt(e[1].toString(2),2),e.length>2&&(t.data2=parseInt(e[2].toString(2),2)),t.channelVoiceMessage.toString(2).slice(0,4)){case"1000":t.type="Note OFF",t.note=t.data1;break;case"1001":t.type="Note ON",t.note=t.data1;break;case"1010":t.type="Polyphonic key pressure";break;case"1011":t.type="Control change",t.controlChange=t.data2;break;case"1100":t.type="Program change";break;case"1101":t.type="Channel Pressure (After-touch)",t.pressure=t.data1;break;case"1110":t.type="Pitch Bend Change",t.pitchBend=t.data2-64,t.pitchBend=-1!==t.pitchBend?t.pitchBend:0}return t}};var h=class{constructor(e){this.MIDIPort=e,this.channels={},this.numKeys=24,this.firstKey=0,this.messagesSubscriptions=[]}connect(){return new Promise((e,t)=>{this.MIDIPort.open().then(t=>{t.onmidimessage=(e=>this.onMessage(e)),e(t)}).catch(e=>t(e))})}onMessage(e){const t=c.parseMessage(e.data);switch(this.channels[t.channel]=this.channels[t.channel]||{posY:0},t.type){case"Note ON":this.updateKeysRange(t.note),this.channels[t.channel].note=t.note;break;case"Note OFF":this.channels[t.channel]={posY:0};break;case"Channel Pressure (After-touch)":this.channels[t.channel].pressure=t.pressure;break;case"Control change":void 0!==this.channels[t.channel].note&&(this.channels[t.channel].posY=t.controlChange);break;case"Pitch Bend Change":this.channels[t.channel].pitchBend=t.pitchBend}this.messagesSubscriptions.length&&this.messagesSubscriptions.forEach(e=>{"function"==typeof e&&e(t)})}subscribeToMessages(e){const t=this.messagesSubscriptions.length;return this.messagesSubscriptions.push(e),t}unsubscribeToMessages(e){this.messagesSubscriptions.splice(e,1)}updateKeysRange(e){if(e>this.firstKey+this.numKeys)for(;e>this.firstKey+this.numKeys;)this.firstKey+=this.numKeys/2;else if(e<this.firstKey)for(;e<this.firstKey;)this.firstKey-=this.numKeys/2}getCoordinates(){const e=[];for(const t in this.channels){const s=this.channels[t],n={};void 0!==s.note&&(s.pitchBend?n.x=s.note+23*s.pitchBend/30-this.firstKey:n.x=s.note-this.firstKey,n.y=125-s.posY,n.size=s.pressure,e.push(n))}return e}},l={name:"Synthgraph",props:{synth:{required:!0}},data:function(){return{stepX:20,sinCosColor:"rgb(0, 243, 255)",sinColor:"rgb(144, 40, 59)",cosColor:"rgb(100, 100, 100)",backgroundColor:"transparent",axesColor:"#e2e2e2"}},computed:{width:function(){return(this.synth.sin.length-1)*this.stepX+2},height:function(){if(this.synth.sin){var e=this.synth.amplitude;return e+e/2}return 60},sinCos:function(){var e=this,t=[];return this.synth.sin.forEach(function(s,n){var i=s,o=e.synth.cosin[n],a=n,r=i*Math.cos(2*Math.PI*a)+o*Math.sin(2*Math.PI*a);t.push(r)}),t}}},u={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"app-container synth-graph"},[e.synth.custom?s("div",[s("svg",{attrs:{width:"80vh",height:"60vh",viewBox:"0 0 "+e.width+" "+e.height}},[s("rect",{attrs:{fill:e.backgroundColor,width:e.width,height:e.height}}),e._v(" "),s("line",{attrs:{x1:"0",y1:e.height/2,x2:e.width,y2:e.height/2,stroke:e.axesColor,"stroke-width":"0.1"}}),e._v(" "),s("line",{attrs:{x1:"2",y1:"0",x2:"2",y2:e.height,stroke:e.axesColor,"stroke-width":"0.1"}}),e._v(" "),e._l(e.synth.sin,function(t,n){return s("circle",{key:n+"-sinDot",attrs:{r:"0.2",stroke:e.sinColor,"stroke-width":"0.2",cx:n*e.stepX+2,cy:-t+e.height/2}})}),e._v(" "),e._l(e.synth.sin,function(t,n){return n?s("line",{key:n+"-sinLine",attrs:{x1:(n-1)*e.stepX+2,y1:-e.synth.sin[n-1]+e.height/2,x2:n*e.stepX+2,y2:-t+e.height/2,stroke:e.sinColor,"stroke-width":"0.1"}}):e._e()}),e._v(" "),e._l(e.synth.cosin,function(t,n){return s("circle",{key:n+"-cosinDot",attrs:{r:"0.2",stroke:e.cosColor,"stroke-width":"0.2",cx:n*e.stepX+2,cy:-t+e.height/2}})}),e._v(" "),e._l(e.synth.cosin,function(t,n){return n?s("line",{key:n+"-cosinLine",attrs:{x1:(n-1)*e.stepX+2,y1:-e.synth.cosin[n-1]+e.height/2,x2:n*e.stepX+2,y2:-t+e.height/2,stroke:e.cosColor,"stroke-width":"0.1"}}):e._e()}),e._v(" "),e._l(e.sinCos,function(t,n){return s("circle",{key:n+"-sincosDot",attrs:{r:"0.2",stroke:e.sinCosColor,"stroke-width":"0.2",cx:n*e.stepX+2,cy:-t+e.height/2}})}),e._v(" "),e._l(e.sinCos,function(t,n){return n?s("line",{key:n+"-sincosLine",attrs:{x1:(n-1)*e.stepX+2,y1:-e.sinCos[n-1]+e.height/2,x2:n*e.stepX+2,y2:-t+e.height/2,stroke:e.sinCosColor,"stroke-width":"0.1"}}):e._e()})],2)]):s("div",[e._v("\n  Only custom synthetizers can be represented by a graph\n")])])},staticRenderFns:[]};var d=s("VU/8")(l,u,!1,function(e){s("Qji5")},"data-v-441f8baa",null).exports,p={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return"classic"!==e.synth.type?s("div",{staticClass:"app-container synth-details"},[s("h3",[e._v(e._s(e.synth.name))]),e._v(" "),s("p",[e._v("Type: "+e._s(e.synth.type)+" synthetizer")]),e._v(" "),s("p",[e._v("Amplitude: "+e._s(e.synth.amplitude)+" Hz")]),e._v(" "),s("p",[e._v("Gain Variation: "+e._s(e.synth.configuration.gain||0))]),e._v(" "),s("p",[e._v("Samples: "+e._s(e.synth.sin.length))]),e._v(" "),"function"===e.synth.type?s("p",[e._v("Function: "+e._s(e.synth.function.toString()))]):e._e()]):s("div",{staticClass:"app-container synth-details"},[e._v("\n  Select a custom synthetizer to display its details\n")])},staticRenderFns:[]};var f=s("VU/8")({name:"SynthDetails",props:{synth:{required:!0}}},p,!1,function(e){s("eY/u")},null,null).exports;var y=[new o("Synthetizer 1 (Classic Sine)"),new o("Synthetizer 2 (Classic Square)",{fadeTime:.3,type:"square"}),new o("Synthetizer 3 (Classic Sawtooth)",{fadeTime:.3,type:"sawtooth"}),new o("Synthetizer 4 (Classic Triangle)",{fadeTime:.3,type:"triangle"}),new a("Sine Climb",{fadeTime:.3},[0,-3,-2,-1,0,1,2,3],[0,-3,0,0,0,0,0,0]),new a("Organ",{fadeTime:.01},[0,-3,3,-3,3],[0,0,0,0,0]),new a("Faded Organ",{fadeTime:1},[0,-3,3,-3,3],[0,0,0,0,0]),new a("Classic Synth",{fadeTime:.3},[0,0,1],[0,1,0]),new a("Magic Bells",{fadeTime:.9},[0,0,0,0,0,-3],[0,0,0,0,0,0]),new a("Low Oscillator 1",{fadeTime:.3},[1,1,0,0],[1,0,0,0]),new a("Low Oscillator 2",{fadeTime:.3},[6,6,0,0],[0,0,0,0],!0),new a("Horn",{fadeTime:.3},[0,.4,.4,1,1,1,.3,.7,.6,.5,.9,.8],new Int8Array(12)),new r("Creepy Exp Function Synth",{fadeTime:.3},e=>Math.pow(2*Math.PI,e)),new r("Rhods Like",{fadeTime:.5},e=>5-e,!1,6),new r("DJames Bass 1",{fadeTime:.3},e=>Math.cos(e)*e*Math.PI,!1,50),new a("Cheap Strings",{fadeTime:.7,gain:0},[1.5,.5,1,-1.5,-1,-1.5,-1,-1.5,-1,0,.5,1.3,1,0,-.5,-.5,-.5,-.5,0,.25,.5],new Int8Array(21),!1),new r("Negative Pow Function",{fadeTime:.3},e=>Math.pow(e,.9),!1,20),new a("Clean Space Synth",{fadeTime:.5},[0,1,2,3,2,0,0,0],[0,1,2,3,2,0,0,0],!1,5),new r("Old School Synth",{fadeTime:.5},e=>e*Math.sin(e)+e*Math.tan(e),!1,100),new r("FlashBack",{fadeTime:.5},e=>Math.tan(e)+Math.pow(e,3)/100,!1,13),new r("High Pitched Buzzer",{fadeTime:.5},e=>Math.tan(e)+Math.pow(e,1.2)/10,!1,40)],g={name:"Synthetizers",components:{SynthGraph:d,SynthDetails:f},props:{seaboard:{required:!0}},data:function(){return{message:"",synthetizers:y,selected:"",synthetizer:null,subscription:null}},created:function(){var e=this;this.subscription=this.seaboard.subscribeToMessages(function(t){e.synthetizer&&e.synthetizer.handleMessage(t),e.message=t})},methods:{onSelection:function(e){console.log("Synthetizers :: selected",name),this.synthetizer=e}},destroyed:function(){this.seaboard.unsubscribeToMessages(this.subscription)}},v={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"flex-container"},[s("div",{staticClass:"app-container synthetizers-list"},[s("h2",[e._v("Synthesizers")]),e._v(" "),s("div",e._l(e.synthetizers,function(t){return s("div",{key:t.name,staticClass:"option-light",class:{selected:e.synthetizer===t},on:{click:function(s){e.onSelection(t)}}},[e._v(e._s(t.name))])}))]),e._v(" "),e.synthetizer?s("synth-graph",{attrs:{id:"synth-graph",synth:e.synthetizer}}):e._e(),e._v(" "),e.synthetizer?s("synth-details",{attrs:{synth:e.synthetizer}}):e._e()],1)},staticRenderFns:[]};var m=s("VU/8")(g,v,!1,function(e){s("vhJh")},"data-v-21aeb5cc",null).exports,b=s("RRo+"),w=s.n(b),_={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return e.seaboard?s("svg",{attrs:{width:e.width,height:e.height,viewPort:"0 0 "+e.width+" "+e.height}},[s("rect",{attrs:{width:"100%",height:"100%",fill:"transparent",rx:"10",ry:"10"}}),e._v(" "),e._l(24,function(t){return s("line",{key:t+"-keyline",attrs:{x1:t*(e.width/23),y1:"20",x2:t*(e.width/23),y2:e.height-e.height/5,stroke:"rgba(255, 255, 255, 0.3)","stroke-width":"1"}})}),e._v(" "),e._l([1,3,6,8,10,13,15,18,20,22],function(t){return s("line",{key:t+"-black-keyline",attrs:{x1:t*(e.width/23),y1:"20",x2:t*(e.width/23),y2:e.height/2.5,stroke:"rgba(255, 255, 255, 0.7)","stroke-width":"2"}})}),e._v(" "),e._l(e.seaboard.getCoordinates(),function(t,n){return s("circle",{key:n,attrs:{cx:50*t.x,cy:t.y*(e.height/140),"stroke-width":"1",stroke:"white",fill:"rgb(0, "+t.size+", "+(t.size+40)+")",r:t.size}})})],2):e._e()},staticRenderFns:[]};var C={name:"KeyTracker",props:{seaboard:{required:!0}},computed:{octave:function(){var e=this.seaboard.firstKey/this.seaboard.numKeys;return w()(e)||(e+=.5),e-1}},components:{Visualizer:s("VU/8")({name:"Visualizer",props:{seaboard:{required:!0}},data:function(){return{height:200,width:1150}},created:function(){var e=this;this.seaboard.subscribeToMessages(function(t){e.$forceUpdate()})}},_,!1,function(e){s("79Kr")},"data-v-abbeb010",null).exports}},k={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{staticClass:"app-container visualizer-container"},[t("visualizer",{attrs:{seaboard:this.seaboard}}),this._v(" "),t("p",{staticClass:"keys"},[this._v("C"+this._s(this.octave))])],1)},staticRenderFns:[]};var x=s("VU/8")(C,k,!1,function(e){s("N4os")},null,null).exports;function I(e,t,s){this.context=e,this.urlList=t,this.onload=s,this.bufferList=new Array,this.loadCount=0}I.prototype.loadBuffer=function(e,t){var s=new XMLHttpRequest;s.open("GET",e,!0),s.responseType="arraybuffer";var n=this;s.onload=function(){n.context.decodeAudioData(s.response,function(s){s?(n.bufferList[t]=s,++n.loadCount==n.urlList.length&&n.onload(n.bufferList)):alert("error decoding file data: "+e)},function(e){console.error("decodeAudioData error",e)})},s.onerror=function(){alert("BufferLoader: XHR error")},s.send()},I.prototype.load=function(){for(var e=0;e<this.urlList.length;++e)this.loadBuffer(this.urlList[e],e)};var M=I,T=["static/piano.wav"],S={name:"Sample",props:{seaboard:{required:!0}},data:function(){return{message:"",samples:T,selected:""}},created:function(){var e=this;this.audioContext=new(window.AudioContext||window.webkitAudioContext),this.bufferLoader=new M(this.audioContext,["static/piano.wav"],function(t){return e.bufferLoaded(t)}),this.bufferLoader.load(),this.seaboard.subscribeToMessages(function(t){switch(e.message=t,t.type){case"Note ON":e.playNote(t)}})},methods:{onSelection:function(e){console.log("Sample :: selected",e),this.selected=e},playNote:function(e){this.source=this.audioContext.createBufferSource(),this.source.buffer=this.buffer,console.log(this.source),this.source.connect(this.audioContext.destination),this.source.start(),console.log("Playing note",e.note)},bufferLoaded:function(e){console.log("bufferLoaded",e),this.buffer=e[0]}}},z={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("h2",[e._v("Select your sample")]),e._v(" "),s("div",[s("select",{directives:[{name:"model",rawName:"v-model",value:e.selected,expression:"selected"}],on:{input:function(t){e.onSelection(t.target.value)},change:function(t){var s=Array.prototype.filter.call(t.target.options,function(e){return e.selected}).map(function(e){return"_value"in e?e._value:e.value});e.selected=t.target.multiple?s:s[0]}}},[s("option",{attrs:{disabled:"",value:""}},[e._v("Choose")]),e._v(" "),e._l(e.samples,function(t){return s("option",{key:t,attrs:{selected:""}},[e._v(" "+e._s(t))])})],2)])])},staticRenderFns:[]};s("VU/8")(S,z,!1,function(e){s("r9tT")},null,null).exports;var A={name:"App",components:{Synthetizers:m,KeyTracker:x},data:function(){return{seaboardInputs:[],selected:null,seaboard:null}},created:function(){this.loadSeaboardInputs()},methods:{loadSeaboardInputs:function(){var e=this;c.getInputs().then(function(t){e.seaboardInputs=t})},connect:function(){this.seaboard=new h(this.selected),this.seaboard.connect().then(function(e){return console.log(e)}).catch(function(e){return console.error(e)})}}},N={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{attrs:{id:"app"}},[e._m(0),e._v(" "),e.seaboardInputs.length&&!e.seaboard?s("div",{staticClass:"app-container midi-input-select"},[s("h3",[e._v("Which MIDI Input should we use?")]),e._v(" "),e._l(e.seaboardInputs,function(t,n){return s("div",{key:n,staticClass:"option-light",class:{selected:e.selected===t},on:{click:function(s){e.selected=t}}},[e._v(e._s(t.name)+"\n    ")])}),e._v(" "),e.selected?s("button",{on:{click:e.connect}},[e._v("Connect")]):e._e()],2):e._e(),e._v(" "),e.seaboardInputs.length?e._e():s("div",{staticClass:"app-container midi-input-select"},[e._v("\n    No MIDI Input found, please check the connection and hit "),s("button",{on:{click:e.loadSeaboardInputs}},[e._v("Reload")])]),e._v(" "),e.seaboard?s("div",[s("synthetizers",{attrs:{seaboard:e.seaboard}}),e._v(" "),s("key-tracker",{attrs:{seaboard:e.seaboard}})],1):e._e()])},staticRenderFns:[function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app-header"}},[t("h3",[this._v("Surfboard")])])}]};var P=s("VU/8")(A,N,!1,function(e){s("pcJs")},null,null).exports;n.a.config.productionTip=!1,new n.a({el:"#app",components:{App:P},template:"<App/>"})},Qji5:function(e,t){},"eY/u":function(e,t){},pcJs:function(e,t){},r9tT:function(e,t){},vhJh:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.d8878085019fd8e854c6.js.map